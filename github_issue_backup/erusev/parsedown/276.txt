{
  "url": "https://api.github.com/repos/erusev/parsedown/issues/276",
  "labels_url": "https://api.github.com/repos/erusev/parsedown/issues/276/labels{/name}",
  "comments_url": "https://api.github.com/repos/erusev/parsedown/issues/276/comments",
  "events_url": "https://api.github.com/repos/erusev/parsedown/issues/276/events",
  "html_url": "https://github.com/erusev/parsedown/pull/276",
  "id": 54971979,
  "number": 276,
  "title": "Prevent various XSS attacks",
  "user": {
    "login": "naNuke",
    "id": 4591126,
    "avatar_url": "https://avatars.githubusercontent.com/u/4591126?v=3",
    "gravatar_id": "",
    "url": "https://api.github.com/users/naNuke",
    "html_url": "https://github.com/naNuke",
    "followers_url": "https://api.github.com/users/naNuke/followers",
    "following_url": "https://api.github.com/users/naNuke/following{/other_user}",
    "gists_url": "https://api.github.com/users/naNuke/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/naNuke/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/naNuke/subscriptions",
    "organizations_url": "https://api.github.com/users/naNuke/orgs",
    "repos_url": "https://api.github.com/users/naNuke/repos",
    "events_url": "https://api.github.com/users/naNuke/events{/privacy}",
    "received_events_url": "https://api.github.com/users/naNuke/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "url": "https://api.github.com/repos/erusev/parsedown/labels/priority",
      "name": "priority",
      "color": "fef2c0"
    },
    {
      "url": "https://api.github.com/repos/erusev/parsedown/labels/suggestion",
      "name": "suggestion",
      "color": "bfd4f2"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "milestone": null,
  "comments": 23,
  "created_at": "2015-01-21T03:05:30Z",
  "updated_at": "2015-05-22T19:41:18Z",
  "closed_at": null,
  "pull_request": {
    "url": "https://api.github.com/repos/erusev/parsedown/pulls/276",
    "html_url": "https://github.com/erusev/parsedown/pull/276",
    "diff_url": "https://github.com/erusev/parsedown/pull/276.diff",
    "patch_url": "https://github.com/erusev/parsedown/pull/276.patch"
  },
  "body": "Hello, I am back with the safe links issue. \r\nAs always this is open to discussion :) but together with already existing markupEscaped setting, this is basically a fix for issues #161 and #210, and maybe other im not aware of.",
  "closed_by": null
}
BODY STARTS FROM HERE
[
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71329879",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71329879",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71329879,
    "user": {
      "login": "erusev",
      "id": 184170,
      "avatar_url": "https://avatars.githubusercontent.com/u/184170?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erusev",
      "html_url": "https://github.com/erusev",
      "followers_url": "https://api.github.com/users/erusev/followers",
      "following_url": "https://api.github.com/users/erusev/following{/other_user}",
      "gists_url": "https://api.github.com/users/erusev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erusev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erusev/subscriptions",
      "organizations_url": "https://api.github.com/users/erusev/orgs",
      "repos_url": "https://api.github.com/users/erusev/repos",
      "events_url": "https://api.github.com/users/erusev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erusev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T18:05:46Z",
    "updated_at": "2015-01-24T18:08:53Z",
    "body": "This looks nice. I'd love to hear more opinions about it. I'm no expert on XSS. @hkdobrev ?"
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71330329",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71330329",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71330329,
    "user": {
      "login": "xPaw",
      "id": 613331,
      "avatar_url": "https://avatars.githubusercontent.com/u/613331?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xPaw",
      "html_url": "https://github.com/xPaw",
      "followers_url": "https://api.github.com/users/xPaw/followers",
      "following_url": "https://api.github.com/users/xPaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/xPaw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xPaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xPaw/subscriptions",
      "organizations_url": "https://api.github.com/users/xPaw/orgs",
      "repos_url": "https://api.github.com/users/xPaw/repos",
      "events_url": "https://api.github.com/users/xPaw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xPaw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T18:15:03Z",
    "updated_at": "2015-01-24T18:15:03Z",
    "body": "I feel like this param should be named as something more generic like `safeAttributes` and escaping every attribute that user can enter (e.g `title`). Also I think checking for `javascript:` in urls seems like a silly idea, and urls should be escaped regardless."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71330817",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71330817",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71330817,
    "user": {
      "login": "erusev",
      "id": 184170,
      "avatar_url": "https://avatars.githubusercontent.com/u/184170?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erusev",
      "html_url": "https://github.com/erusev",
      "followers_url": "https://api.github.com/users/erusev/followers",
      "following_url": "https://api.github.com/users/erusev/following{/other_user}",
      "gists_url": "https://api.github.com/users/erusev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erusev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erusev/subscriptions",
      "organizations_url": "https://api.github.com/users/erusev/orgs",
      "repos_url": "https://api.github.com/users/erusev/repos",
      "events_url": "https://api.github.com/users/erusev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erusev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T18:26:18Z",
    "updated_at": "2015-01-24T18:26:51Z",
    "body": "@xPaw Thanks for the input! Which characters do u think should be escaped?"
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71330877",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71330877",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71330877,
    "user": {
      "login": "xPaw",
      "id": 613331,
      "avatar_url": "https://avatars.githubusercontent.com/u/613331?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xPaw",
      "html_url": "https://github.com/xPaw",
      "followers_url": "https://api.github.com/users/xPaw/followers",
      "following_url": "https://api.github.com/users/xPaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/xPaw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xPaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xPaw/subscriptions",
      "organizations_url": "https://api.github.com/users/xPaw/orgs",
      "repos_url": "https://api.github.com/users/xPaw/repos",
      "events_url": "https://api.github.com/users/xPaw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xPaw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T18:27:41Z",
    "updated_at": "2015-01-24T18:27:41Z",
    "body": "Using `htmlspecialchars` should do the job just fine."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71330973",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71330973",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71330973,
    "user": {
      "login": "erusev",
      "id": 184170,
      "avatar_url": "https://avatars.githubusercontent.com/u/184170?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erusev",
      "html_url": "https://github.com/erusev",
      "followers_url": "https://api.github.com/users/erusev/followers",
      "following_url": "https://api.github.com/users/erusev/following{/other_user}",
      "gists_url": "https://api.github.com/users/erusev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erusev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erusev/subscriptions",
      "organizations_url": "https://api.github.com/users/erusev/orgs",
      "repos_url": "https://api.github.com/users/erusev/repos",
      "events_url": "https://api.github.com/users/erusev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erusev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T18:29:53Z",
    "updated_at": "2015-01-24T18:31:06Z",
    "body": "Thanks! \r\n\r\n> escaping every attribute that user can enter (e.g title)\r\n\r\nIs this about attributes of anchor (`<a>`) tags or all of them?"
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71331235",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71331235",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71331235,
    "user": {
      "login": "xPaw",
      "id": 613331,
      "avatar_url": "https://avatars.githubusercontent.com/u/613331?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xPaw",
      "html_url": "https://github.com/xPaw",
      "followers_url": "https://api.github.com/users/xPaw/followers",
      "following_url": "https://api.github.com/users/xPaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/xPaw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xPaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xPaw/subscriptions",
      "organizations_url": "https://api.github.com/users/xPaw/orgs",
      "repos_url": "https://api.github.com/users/xPaw/repos",
      "events_url": "https://api.github.com/users/xPaw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xPaw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T18:35:49Z",
    "updated_at": "2015-01-24T18:35:49Z",
    "body": "Any attribute that user can change should be escaped. I guess in Parsedown that only applies to links really."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71331724",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71331724",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71331724,
    "user": {
      "login": "erusev",
      "id": 184170,
      "avatar_url": "https://avatars.githubusercontent.com/u/184170?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erusev",
      "html_url": "https://github.com/erusev",
      "followers_url": "https://api.github.com/users/erusev/followers",
      "following_url": "https://api.github.com/users/erusev/following{/other_user}",
      "gists_url": "https://api.github.com/users/erusev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erusev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erusev/subscriptions",
      "organizations_url": "https://api.github.com/users/erusev/orgs",
      "repos_url": "https://api.github.com/users/erusev/repos",
      "events_url": "https://api.github.com/users/erusev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erusev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T18:47:44Z",
    "updated_at": "2015-01-24T18:49:12Z",
    "body": "What if, instead of having an option, we implement this as a default behaviour? It shouldn't have too much of a performance cost."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71331835",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71331835",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71331835,
    "user": {
      "login": "xPaw",
      "id": 613331,
      "avatar_url": "https://avatars.githubusercontent.com/u/613331?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xPaw",
      "html_url": "https://github.com/xPaw",
      "followers_url": "https://api.github.com/users/xPaw/followers",
      "following_url": "https://api.github.com/users/xPaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/xPaw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xPaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xPaw/subscriptions",
      "organizations_url": "https://api.github.com/users/xPaw/orgs",
      "repos_url": "https://api.github.com/users/xPaw/repos",
      "events_url": "https://api.github.com/users/xPaw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xPaw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T18:50:01Z",
    "updated_at": "2015-01-24T18:50:01Z",
    "body": "That actually would make more sense."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71332079",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71332079",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71332079,
    "user": {
      "login": "naNuke",
      "id": 4591126,
      "avatar_url": "https://avatars.githubusercontent.com/u/4591126?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naNuke",
      "html_url": "https://github.com/naNuke",
      "followers_url": "https://api.github.com/users/naNuke/followers",
      "following_url": "https://api.github.com/users/naNuke/following{/other_user}",
      "gists_url": "https://api.github.com/users/naNuke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naNuke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naNuke/subscriptions",
      "organizations_url": "https://api.github.com/users/naNuke/orgs",
      "repos_url": "https://api.github.com/users/naNuke/repos",
      "events_url": "https://api.github.com/users/naNuke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naNuke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T18:55:25Z",
    "updated_at": "2015-01-24T19:02:02Z",
    "body": "We dont need to escape title attribute because of the way how parsedown works, any additional quote simply breaks the regex and link wont render at all.\r\n\r\nthing like ```[example](www.example.com \"><script>alert('xss')</script>\")```\r\nends up as ```<a href=\"www.example.com\" title=\"><script>alert('xss')</script>\">``` and wont do anything. Script tags broken anywhere outside the link will be escaped if markupEscaped is on.\r\n\r\nBut adding escape on title is easy if there is really need for it.\r\n\r\nThe check against javascript: in url is to prevent people from writing clickable javascript links which can be used as an XSS attack because you can write full strings in javascript without quotes so even with ENT_QUOTES on htmlspecialchars wont prevent someone from writing malicious code."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71332418",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71332418",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71332418,
    "user": {
      "login": "erusev",
      "id": 184170,
      "avatar_url": "https://avatars.githubusercontent.com/u/184170?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erusev",
      "html_url": "https://github.com/erusev",
      "followers_url": "https://api.github.com/users/erusev/followers",
      "following_url": "https://api.github.com/users/erusev/following{/other_user}",
      "gists_url": "https://api.github.com/users/erusev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erusev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erusev/subscriptions",
      "organizations_url": "https://api.github.com/users/erusev/orgs",
      "repos_url": "https://api.github.com/users/erusev/repos",
      "events_url": "https://api.github.com/users/erusev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erusev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T19:02:33Z",
    "updated_at": "2015-01-24T19:03:14Z",
    "body": "@xPaw Would `htmlspecialchars` on attributes protect against things like `[link](javascript:alert('xss'))`?"
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71332548",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71332548",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71332548,
    "user": {
      "login": "xPaw",
      "id": 613331,
      "avatar_url": "https://avatars.githubusercontent.com/u/613331?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xPaw",
      "html_url": "https://github.com/xPaw",
      "followers_url": "https://api.github.com/users/xPaw/followers",
      "following_url": "https://api.github.com/users/xPaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/xPaw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xPaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xPaw/subscriptions",
      "organizations_url": "https://api.github.com/users/xPaw/orgs",
      "repos_url": "https://api.github.com/users/xPaw/repos",
      "events_url": "https://api.github.com/users/xPaw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xPaw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T19:06:04Z",
    "updated_at": "2015-01-24T19:06:04Z",
    "body": "It won't, but simply checking if the string starts with `javascript:` won't fix the problem either.\r\n\r\nSee http://security.stackexchange.com/a/73751 for some examples as to why."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71335810",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71335810",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71335810,
    "user": {
      "login": "erusev",
      "id": 184170,
      "avatar_url": "https://avatars.githubusercontent.com/u/184170?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erusev",
      "html_url": "https://github.com/erusev",
      "followers_url": "https://api.github.com/users/erusev/followers",
      "following_url": "https://api.github.com/users/erusev/following{/other_user}",
      "gists_url": "https://api.github.com/users/erusev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erusev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erusev/subscriptions",
      "organizations_url": "https://api.github.com/users/erusev/orgs",
      "repos_url": "https://api.github.com/users/erusev/repos",
      "events_url": "https://api.github.com/users/erusev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erusev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T20:28:55Z",
    "updated_at": "2015-01-25T00:30:26Z",
    "body": "I asked SO for advice at http://security.stackexchange.com/q/80003/15034"
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71338681",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71338681",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71338681,
    "user": {
      "login": "naNuke",
      "id": 4591126,
      "avatar_url": "https://avatars.githubusercontent.com/u/4591126?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naNuke",
      "html_url": "https://github.com/naNuke",
      "followers_url": "https://api.github.com/users/naNuke/followers",
      "following_url": "https://api.github.com/users/naNuke/following{/other_user}",
      "gists_url": "https://api.github.com/users/naNuke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naNuke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naNuke/subscriptions",
      "organizations_url": "https://api.github.com/users/naNuke/orgs",
      "repos_url": "https://api.github.com/users/naNuke/repos",
      "events_url": "https://api.github.com/users/naNuke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naNuke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-24T21:39:28Z",
    "updated_at": "2015-01-24T21:39:28Z",
    "body": "Updated with info from @xPaw to whitelist the protocols instead of javascript: check.\r\nDidn't know the pseudo-protocol can be malformed in some browsers ^^\r\nAlso escaping title just to be 100% sure."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71381132",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71381132",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71381132,
    "user": {
      "login": "xPaw",
      "id": 613331,
      "avatar_url": "https://avatars.githubusercontent.com/u/613331?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xPaw",
      "html_url": "https://github.com/xPaw",
      "followers_url": "https://api.github.com/users/xPaw/followers",
      "following_url": "https://api.github.com/users/xPaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/xPaw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xPaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xPaw/subscriptions",
      "organizations_url": "https://api.github.com/users/xPaw/orgs",
      "repos_url": "https://api.github.com/users/xPaw/repos",
      "events_url": "https://api.github.com/users/xPaw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xPaw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-25T17:00:30Z",
    "updated_at": "2015-01-25T17:00:36Z",
    "body": "I don't think having hardcoded schema list in the regex is the way to go. For example reddit has a bigger schema whitelist: https://github.com/reddit/reddit/blob/bb0f5b552c3a52abfac1e2147144eef8f2e7dfab/r2/r2/lib/filters.py#L177"
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71385737",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71385737",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71385737,
    "user": {
      "login": "naNuke",
      "id": 4591126,
      "avatar_url": "https://avatars.githubusercontent.com/u/4591126?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naNuke",
      "html_url": "https://github.com/naNuke",
      "followers_url": "https://api.github.com/users/naNuke/followers",
      "following_url": "https://api.github.com/users/naNuke/following{/other_user}",
      "gists_url": "https://api.github.com/users/naNuke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naNuke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naNuke/subscriptions",
      "organizations_url": "https://api.github.com/users/naNuke/orgs",
      "repos_url": "https://api.github.com/users/naNuke/repos",
      "events_url": "https://api.github.com/users/naNuke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naNuke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-25T18:50:02Z",
    "updated_at": "2015-01-25T18:50:02Z",
    "body": "Thanks for input :) added customizable whitelist, but since parsedown is parser meant for everyone I am not sure if it should include all possible schemas by default. Thoughts?"
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71436420",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71436420",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71436420,
    "user": {
      "login": "hkdobrev",
      "id": 506129,
      "avatar_url": "https://avatars.githubusercontent.com/u/506129?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hkdobrev",
      "html_url": "https://github.com/hkdobrev",
      "followers_url": "https://api.github.com/users/hkdobrev/followers",
      "following_url": "https://api.github.com/users/hkdobrev/following{/other_user}",
      "gists_url": "https://api.github.com/users/hkdobrev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hkdobrev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hkdobrev/subscriptions",
      "organizations_url": "https://api.github.com/users/hkdobrev/orgs",
      "repos_url": "https://api.github.com/users/hkdobrev/repos",
      "events_url": "https://api.github.com/users/hkdobrev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hkdobrev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-26T09:52:26Z",
    "updated_at": "2015-01-26T14:04:49Z",
    "body": "Here a few things I think should be done in order Parsedown to be more safe against XSS.\r\n\r\n#### HTML\r\n\r\nRaw HTML should be disabled in Markdown. You could use `setMarkupEscaped()` in Parsedown.\r\n\r\n#### User-generated content\r\n\r\nIf a developer is getting user-generated content and is putting it inside Markdown documents this should be escaped/validated beforehand. You could also use HTML Purifier or a similar library to actually validate/escape content after the HTML is generated.\r\n\r\n#### Attributes\r\n\r\nEvery attribute should be escaped for special characters, not only links. In Parsedown this would be the `href`, `title`, `src` and `alt` attributes.\r\n\r\n#### Schemas:\r\n\r\n1. There is no definitive list of schemas, because you can create your own.\r\n2. [According to OWASP](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet#XSS_Prevention_Rules_Summary) you should whitelist `http://` and `https://` only for security purposes.\r\n\r\n---\r\n\r\nDon't take this the wrong way, I think this is a step in the right direction.\r\n\r\nAbout what @erusev suggested that this might be the default:\r\n\r\n- Attributes escaping could be done by default.\r\n- HTML escaping is already behind an option and of course should stay that way.\r\n- Schema whitelisting definitely should be optional.\r\n- A note which says Parsedown is not enough for your content to be secure would be good. Users which use Parsedown should be educated to think about their content and which text comes from where."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71457872",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71457872",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71457872,
    "user": {
      "login": "naNuke",
      "id": 4591126,
      "avatar_url": "https://avatars.githubusercontent.com/u/4591126?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naNuke",
      "html_url": "https://github.com/naNuke",
      "followers_url": "https://api.github.com/users/naNuke/followers",
      "following_url": "https://api.github.com/users/naNuke/following{/other_user}",
      "gists_url": "https://api.github.com/users/naNuke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naNuke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naNuke/subscriptions",
      "organizations_url": "https://api.github.com/users/naNuke/orgs",
      "repos_url": "https://api.github.com/users/naNuke/repos",
      "events_url": "https://api.github.com/users/naNuke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naNuke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-26T13:08:12Z",
    "updated_at": "2015-01-26T13:26:44Z",
    "body": "Is there any other markdown syntax that accepts user content directly for its generated html other than links and images? \r\n\r\nAlso note that there is no need atm to escape images because it uses link code directly."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/71506293",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-71506293",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 71506293,
    "user": {
      "login": "naNuke",
      "id": 4591126,
      "avatar_url": "https://avatars.githubusercontent.com/u/4591126?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naNuke",
      "html_url": "https://github.com/naNuke",
      "followers_url": "https://api.github.com/users/naNuke/followers",
      "following_url": "https://api.github.com/users/naNuke/following{/other_user}",
      "gists_url": "https://api.github.com/users/naNuke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naNuke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naNuke/subscriptions",
      "organizations_url": "https://api.github.com/users/naNuke/orgs",
      "repos_url": "https://api.github.com/users/naNuke/repos",
      "events_url": "https://api.github.com/users/naNuke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naNuke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-01-26T18:02:06Z",
    "updated_at": "2015-01-26T18:02:06Z",
    "body": "I've just finished reading thru the code and added escaping on *hopefully* all parsed attributes.\r\n\r\nOn another note, at the moment, all of this expects user input to be UTF-8, which may leave some project vulnerable by not catching html entities under different encodings. [Read here for more info](http://blog.astrumfutura.com/2012/03/a-hitchhikers-guide-to-cross-site-scripting-xss-in-php-part-1-how-not-to-use-htmlspecialchars-for-output-escaping/)\r\n\r\nI am not quite sure how to solve the encoding issue since that might be out of scope of this fix, also the fact that parsedown is supporting php 5.2 is not helping, but my idea of possible solution is:\r\n\r\n- text() method would accept encoding parameter, encode from that encoding to utf-8, go through all the lines, then re-encode back to user encoding and return.\r\n\r\nNot aware of any complications this might bring, but I am not that knowledgeable about unicode.\r\n\r\nLet me know what you guys think :)"
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/72629102",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-72629102",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 72629102,
    "user": {
      "login": "hkdobrev",
      "id": 506129,
      "avatar_url": "https://avatars.githubusercontent.com/u/506129?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hkdobrev",
      "html_url": "https://github.com/hkdobrev",
      "followers_url": "https://api.github.com/users/hkdobrev/followers",
      "following_url": "https://api.github.com/users/hkdobrev/following{/other_user}",
      "gists_url": "https://api.github.com/users/hkdobrev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hkdobrev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hkdobrev/subscriptions",
      "organizations_url": "https://api.github.com/users/hkdobrev/orgs",
      "repos_url": "https://api.github.com/users/hkdobrev/repos",
      "events_url": "https://api.github.com/users/hkdobrev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hkdobrev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-02-03T10:38:56Z",
    "updated_at": "2015-02-03T10:38:56Z",
    "body": ":star2:  LGTM :sparkles: :dizzy: "
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/78046302",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-78046302",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 78046302,
    "user": {
      "login": "hkdobrev",
      "id": 506129,
      "avatar_url": "https://avatars.githubusercontent.com/u/506129?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hkdobrev",
      "html_url": "https://github.com/hkdobrev",
      "followers_url": "https://api.github.com/users/hkdobrev/followers",
      "following_url": "https://api.github.com/users/hkdobrev/following{/other_user}",
      "gists_url": "https://api.github.com/users/hkdobrev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hkdobrev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hkdobrev/subscriptions",
      "organizations_url": "https://api.github.com/users/hkdobrev/orgs",
      "repos_url": "https://api.github.com/users/hkdobrev/repos",
      "events_url": "https://api.github.com/users/hkdobrev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hkdobrev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-10T12:48:31Z",
    "updated_at": "2015-03-10T12:48:31Z",
    "body": "@erusev What's up with this?"
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/78047485",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-78047485",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 78047485,
    "user": {
      "login": "erusev",
      "id": 184170,
      "avatar_url": "https://avatars.githubusercontent.com/u/184170?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erusev",
      "html_url": "https://github.com/erusev",
      "followers_url": "https://api.github.com/users/erusev/followers",
      "following_url": "https://api.github.com/users/erusev/following{/other_user}",
      "gists_url": "https://api.github.com/users/erusev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erusev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erusev/subscriptions",
      "organizations_url": "https://api.github.com/users/erusev/orgs",
      "repos_url": "https://api.github.com/users/erusev/repos",
      "events_url": "https://api.github.com/users/erusev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erusev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-10T12:57:46Z",
    "updated_at": "2015-03-10T12:58:36Z",
    "body": "@hkdobrev I have some thoughts about it. Hopefully, next week I'll have some time that I'll be able to invest in the topic."
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/99617635",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-99617635",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 99617635,
    "user": {
      "login": "ivantcholakov",
      "id": 1438104,
      "avatar_url": "https://avatars.githubusercontent.com/u/1438104?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ivantcholakov",
      "html_url": "https://github.com/ivantcholakov",
      "followers_url": "https://api.github.com/users/ivantcholakov/followers",
      "following_url": "https://api.github.com/users/ivantcholakov/following{/other_user}",
      "gists_url": "https://api.github.com/users/ivantcholakov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ivantcholakov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ivantcholakov/subscriptions",
      "organizations_url": "https://api.github.com/users/ivantcholakov/orgs",
      "repos_url": "https://api.github.com/users/ivantcholakov/repos",
      "events_url": "https://api.github.com/users/ivantcholakov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ivantcholakov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-05-06T21:38:48Z",
    "updated_at": "2015-05-06T21:38:48Z",
    "body": "Maybe borrowing code from CodeIgniter 3 would be the solution. PHP min = 5.2.4\r\nhttps://github.com/bcit-ci/CodeIgniter/blob/3.0.0/system/core/Security.php#L349"
  },
  {
    "url": "https://api.github.com/repos/erusev/parsedown/issues/comments/104750884",
    "html_url": "https://github.com/erusev/parsedown/pull/276#issuecomment-104750884",
    "issue_url": "https://api.github.com/repos/erusev/parsedown/issues/276",
    "id": 104750884,
    "user": {
      "login": "adamthehutt",
      "id": 57567,
      "avatar_url": "https://avatars.githubusercontent.com/u/57567?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adamthehutt",
      "html_url": "https://github.com/adamthehutt",
      "followers_url": "https://api.github.com/users/adamthehutt/followers",
      "following_url": "https://api.github.com/users/adamthehutt/following{/other_user}",
      "gists_url": "https://api.github.com/users/adamthehutt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adamthehutt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adamthehutt/subscriptions",
      "organizations_url": "https://api.github.com/users/adamthehutt/orgs",
      "repos_url": "https://api.github.com/users/adamthehutt/repos",
      "events_url": "https://api.github.com/users/adamthehutt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adamthehutt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-05-22T19:41:18Z",
    "updated_at": "2015-05-22T19:41:18Z",
    "body": "Is there any update on this? Anything I can do to help?"
  }
]
