<!DOCTYPE html>
<html class='' lang='en'>
<head prefix='og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# object: http://ogp.me/ns/object# article: http://ogp.me/ns/article# profile: http://ogp.me/ns/profile#'>
<meta http-equiv='content-type' content='text/html; charset=UTF-8'>
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge'>
<meta http-equiv='Content-Language' content='en'>
<title>erusev/parsedown/210</title>
<link href='github-c486157afcc5f58155a921bc675afb08733fbaa8dcf39ac2104d3.css' media='all' rel='stylesheet'>
<link href='github2-da2e842cc3f0aaf33b727d0ef034243c12ab008fd09b24868b97.css' media='all' rel='stylesheet'>
<meta http-equiv='x-pjax-version' content='4426702614c8182f33d1780ad1169662'>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shCore.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shAutoloader.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushAppleScript.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushAS3.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushBash.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushColdFusion.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushCpp.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushCSharp.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushCss.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushDelphi.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushDiff.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushErlang.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushGroovy.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushJava.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushJavaFX.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/syntaxhighlighter/scripts/shBrushJScript.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushPerl.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushPhp.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushPlain.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushPowerShell.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushPython.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushRuby.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushSass.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushScala.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushSql.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushVb.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shBrushXml.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shCore.js'></script>
	<script type='text/javascript' src='syntaxhighlighter/scripts/shLegacy.js'></script>
	<link type='text/css' rel='stylesheet' href='syntaxhighlighter/styles/shCoreDefault.css'/>
	<script type='text/javascript'>SyntaxHighlighter.all();</script>
</head>
<body class='logged_in  env-production windows vis-public'>
<h1 align='center'><a href='https://github.com/erusev/parsedown/issues/210' target='_blank'>XSS Image Tag</h1><hr/><div id="#issue-41373085" class="comment previewable-edit timeline-comment js-comment js-task-list-container owner-comment current-user" data-body-version="3d69eb2502aec4738da37c0867d635da">
  <div class="timeline-comment-header ">
  <div class="timeline-comment-header-text">
    <strong>
      <a href="https://github.com/xLink" class="author">xLink</a>
    </strong>
    commented on 
    <a href="#issue-41373085" class="timestamp">
      <time>2014-08-28 09:50:19</time>
    </a>
  </div>
</div><div class="edit-comment-hide">
      <div class="comment-body markdown-body markdown-format js-comment-body">
          <p>Hey im using your parser in a laravel install, just had someone post </p>
<pre class="brush: md">![" onerror="alert(1)](0 ""alert(2);")</code></pre>
<p>and it return</p>
<pre class="brush: html">&lt;img alt="" onerror="alert(1)" src="0" title=""alert(2);" /&gt;</code></pre>
<p>with this the alert(1) was fired, is there anyway to have this fixed? I am already doing an escape within my code before the markdown gets parsed, but ofc it wouldnt pick this up :/</p>
  </div>
  </div>
  </div>
  <br/>
<div id="#issuecomment-53698288" class="comment previewable-edit timeline-comment js-comment js-task-list-container owner-comment current-user" data-body-version="3d69eb2502aec4738da37c0867d635da">
  <div class="timeline-comment-header ">
  <div class="timeline-comment-header-text">
    <strong>
      <a href="https://github.com/GrahamCampbell" class="author">GrahamCampbell</a>
    </strong>
    commented on 
    <a href="#issuecomment-53698288" class="timestamp">
      <time>2014-08-28 09:55:08</time>
    </a>
  </div>
</div><div class="edit-comment-hide">
      <div class="comment-body markdown-body markdown-format js-comment-body">
          <p>That is behond the scope of parsedown. Use something like htmlpurifier, or my laravel security package to protect against this.</p>
  </div>
  </div>
  </div>
  <br/>
<div id="#issuecomment-53706315" class="comment previewable-edit timeline-comment js-comment js-task-list-container owner-comment current-user" data-body-version="3d69eb2502aec4738da37c0867d635da">
  <div class="timeline-comment-header ">
  <div class="timeline-comment-header-text">
    <strong>
      <a href="https://github.com/xPaw" class="author">xPaw</a>
    </strong>
    commented on 
    <a href="#issuecomment-53706315" class="timestamp">
      <time>2014-08-28 11:13:31</time>
    </a>
  </div>
</div><div class="edit-comment-hide">
      <div class="comment-body markdown-body markdown-format js-comment-body">
          <p>See #161</p>
  </div>
  </div>
  </div>
  <br/>
<div id="#issuecomment-53866922" class="comment previewable-edit timeline-comment js-comment js-task-list-container owner-comment current-user" data-body-version="3d69eb2502aec4738da37c0867d635da">
  <div class="timeline-comment-header ">
  <div class="timeline-comment-header-text">
    <strong>
      <a href="https://github.com/apfelbox" class="author">apfelbox</a>
    </strong>
    commented on 
    <a href="#issuecomment-53866922" class="timestamp">
      <time>2014-08-29 12:02:31</time>
    </a>
  </div>
</div><div class="edit-comment-hide">
      <div class="comment-body markdown-body markdown-format js-comment-body">
          <p>I would argue that this is a bug instead of just waving it off with &quot;parsedown does not sanitize html&quot;.</p>
<p>Even the official spec says something in this direction:</p>
<blockquote>
<p>Ampersands in particular are bedeviling for web writers. If you want to write about ‘AT&amp;T’, you need to write ‘AT&amp;T’. You even need to escape ampersands within URLs.
[...]
Markdown allows you to use these characters naturally, taking care of all the necessary escaping for you. If you use an ampersand as part of an HTML entity, it remains unchanged; otherwise it will be translated into <code>&amp;amp;</code>.</p>
</blockquote>
<p><a href="http://daringfireball.net/projects/markdown/syntax#autoescape">Source</a></p>
<p>So I would argue that since the part in the square brackets of an image link is meant for <code>alt</code> tags, you should be able to write your text &quot;naturally&quot; (quote) and therefore it should be <a href="https://github.com/fabpot/Twig/blob/master/lib/Twig/Extension/Core.php#L1021-1036">properly escaped</a>.</p>
  </div>
  </div>
  </div>
  <br/>
<div id="#issuecomment-53912284" class="comment previewable-edit timeline-comment js-comment js-task-list-container owner-comment current-user" data-body-version="3d69eb2502aec4738da37c0867d635da">
  <div class="timeline-comment-header ">
  <div class="timeline-comment-header-text">
    <strong>
      <a href="https://github.com/hkdobrev" class="author">hkdobrev</a>
    </strong>
    commented on 
    <a href="#issuecomment-53912284" class="timestamp">
      <time>2014-08-29 18:20:55</time>
    </a>
  </div>
</div><div class="edit-comment-hide">
      <div class="comment-body markdown-body markdown-format js-comment-body">
          <p><strong><a href="https://github.com/apfelbox" target="_blank">@apfelbox</a></strong> I think you are talking about encoding HTML entities. This is totally different than preventing XSS. Please correct me if I'm wrong.</p>
  </div>
  </div>
  </div>
  <br/>
<div id="#issuecomment-53951574" class="comment previewable-edit timeline-comment js-comment js-task-list-container owner-comment current-user" data-body-version="3d69eb2502aec4738da37c0867d635da">
  <div class="timeline-comment-header ">
  <div class="timeline-comment-header-text">
    <strong>
      <a href="https://github.com/apfelbox" class="author">apfelbox</a>
    </strong>
    commented on 
    <a href="#issuecomment-53951574" class="timestamp">
      <time>2014-08-30 07:38:59</time>
    </a>
  </div>
</div><div class="edit-comment-hide">
      <div class="comment-body markdown-body markdown-format js-comment-body">
          <p><strong><a href="https://github.com/hkdobrev" target="_blank">@hkdobrev</a></strong> generally it is, in this case it isn't. To prevent this issue you need to correctly encode HTML attribute values - which in this case conveniently also fixes the XSS issues.</p>
<p>Just wanted to say that in this case you can hit two birds with one stone. (There will be still some XSS issues left, but not in the <code>alt</code> tag of images anymore.)</p>
  </div>
  </div>
  </div>
  <br/>
<div id="#issuecomment-57126183" class="comment previewable-edit timeline-comment js-comment js-task-list-container owner-comment current-user" data-body-version="3d69eb2502aec4738da37c0867d635da">
  <div class="timeline-comment-header ">
  <div class="timeline-comment-header-text">
    <strong>
      <a href="https://github.com/xPaw" class="author">xPaw</a>
    </strong>
    commented on 
    <a href="#issuecomment-57126183" class="timestamp">
      <time>2014-09-29 07:37:39</time>
    </a>
  </div>
</div><div class="edit-comment-hide">
      <div class="comment-body markdown-body markdown-format js-comment-body">
          <p>What about simply using htmlentities on $value here? <a href="https://github.com/erusev/parsedown/blob/master/Parsedown.php#L898">https://github.com/erusev/parsedown/blob/master/Parsedown.php#L898</a></p>
  </div>
  </div>
  </div>
  <br/>
<div id="#issuecomment-70074802" class="comment previewable-edit timeline-comment js-comment js-task-list-container owner-comment current-user" data-body-version="3d69eb2502aec4738da37c0867d635da">
  <div class="timeline-comment-header ">
  <div class="timeline-comment-header-text">
    <strong>
      <a href="https://github.com/erusev" class="author">erusev</a>
    </strong>
    commented on 
    <a href="#issuecomment-70074802" class="timestamp">
      <time>2015-01-15 11:48:06</time>
    </a>
  </div>
</div><div class="edit-comment-hide">
      <div class="comment-body markdown-body markdown-format js-comment-body">
          <p>I'm closing this as a duplicate of #161.</p>
  </div>
  </div>
  </div>
  <br/>
</body></html>